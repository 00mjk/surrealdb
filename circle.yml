# -----------------------------------

general:
    branches:
        only:
            - master

# -----------------------------------

machine:
    timezone:
        UTC
    services:
        - docker

# -----------------------------------

dependencies:
    override:
        - docker info
        - docker login -e $DOCKER_EMAIL -u $DOCKER_USER -p $DOCKER_PASS
        - sudo add-apt-repository -y ppa:masterminds/glide
        - sudo apt-get install glide

# -----------------------------------

test:
    override:
        - make test
        - make build
        - docker build -t abcum/surreal .
        - docker run -d abcum/surreal start; sleep 15

# -----------------------------------

deployment:

    deploy:
        branch: master
        commands:
            - docker push abcum/surreal